From 1001fed79ad5be9decdfece91afca2dbba3f188e Mon Sep 17 00:00:00 2001
From: Yuta NAKAI <nak5124@live.jp>
Date: Sun, 3 Nov 2013 18:05:15 +0900
Subject: [PATCH] vslsmashsource: Don't print any info from libav/ffmpeg.

---
 VapourSynth/configure           | 5 +++++
 VapourSynth/libavsmash_source.c | 3 +++
 VapourSynth/lwlibav_source.c    | 3 +++
 3 files changed, 11 insertions(+)

diff --git a/VapourSynth/configure b/VapourSynth/configure
index a840d55..50a8167 100755
--- a/VapourSynth/configure
+++ b/VapourSynth/configure
@@ -15,6 +15,8 @@ options:
   --libdir=DIR             set dir for libs    [NONE]
   --includedir=DIR         set dir for headers [NONE]
 
+  --enable-debug           (-DVSDEBUG)
+
   --extra-cflags=XCFLAGS   add XCFLAGS to CFLAGS
   --extra-ldflags=XLDFLAGS add XLDFLAGS to LDFLAGS
   --extra-libs=XLIBS       add XLIBS to LIBS
@@ -110,6 +112,9 @@ for opt; do
         --includedir=*)
             includedir="$optarg"
             ;;
+        --enable-debug)
+            CFLAGS="$CFLAGS -DVSDEBUG"
+            ;;
         --extra-cflags=*)
             XCFLAGS="$optarg"
             ;;
diff --git a/VapourSynth/libavsmash_source.c b/VapourSynth/libavsmash_source.c
index c15c2cf..5cb5708 100644
--- a/VapourSynth/libavsmash_source.c
+++ b/VapourSynth/libavsmash_source.c
@@ -452,6 +452,9 @@ static int get_video_track( lsmas_handler_t *hp, uint32_t track_number, int thre
 
 void VS_CC vs_libavsmashsource_create( const VSMap *in, VSMap *out, void *user_data, VSCore *core, const VSAPI *vsapi )
 {
+#ifndef VSDEBUG
+    av_log_set_level( AV_LOG_QUIET );
+#endif
     /* Get file name. */
     const char *file_name = vsapi->propGetData( in, "source", 0, NULL );
     if( !file_name )
diff --git a/VapourSynth/lwlibav_source.c b/VapourSynth/lwlibav_source.c
index 5ba74bb..34be382 100644
--- a/VapourSynth/lwlibav_source.c
+++ b/VapourSynth/lwlibav_source.c
@@ -231,6 +231,9 @@ static void VS_CC vs_filter_free( void *instance_data, VSCore *core, const VSAPI
 
 void VS_CC vs_lwlibavsource_create( const VSMap *in, VSMap *out, void *user_data, VSCore *core, const VSAPI *vsapi )
 {
+#ifndef VSDEBUG
+    av_log_set_level( AV_LOG_QUIET );
+#endif
     /* Get file path. */
     const char *file_path = vsapi->propGetData( in, "source", 0, NULL );
     if( !file_path )
-- 
1.8.4.msysgit.0

